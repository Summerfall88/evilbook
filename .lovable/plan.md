

## Авторизация и комментарии к рецензиям

### Что будет сделано

1. **Авторизация пользователей** -- форма входа/регистрации по email и паролю. Кнопка "Войти" появится в шапке сайта. После входа вместо нее будет отображаться имя пользователя и кнопка "Выйти".

2. **Таблица профилей** в Supabase -- при регистрации автоматически создается профиль с отображаемым именем (display_name). Это имя будет показано рядом с комментарием.

3. **Таблица комментариев** в Supabase -- хранит текст комментария, ID рецензии, ID автора комментария и дату.

4. **Блок комментариев на странице рецензии** -- внизу каждой рецензии появится кнопка "Перейти к комментариям". При нажатии раскрывается секция с существующими комментариями (видны всем) и формой отправки (только для авторизованных). Неавторизованным пользователям будет показано предложение войти.

---

### Техническая часть

**База данных (SQL-миграции):**

- Таблица `profiles`:
  - `id` (uuid, PK, ссылка на `auth.users`)
  - `display_name` (text)
  - `created_at` (timestamptz)
  - Триггер для автоматического создания профиля при регистрации
  - RLS: каждый может читать профили; пользователь может обновлять только свой

- Таблица `comments`:
  - `id` (uuid, PK)
  - `review_id` (text, NOT NULL) -- ID рецензии из localStorage
  - `user_id` (uuid, ссылка на `auth.users`)
  - `content` (text, NOT NULL)
  - `created_at` (timestamptz)
  - RLS: все могут читать; авторизованные могут вставлять (только от своего имени); автор может удалять свой комментарий

**Новые компоненты:**

- `src/components/AuthDialog.tsx` -- модальное окно с формами входа и регистрации (email + пароль + display_name при регистрации)
- `src/hooks/useAuth.ts` -- хук для отслеживания состояния авторизации через `onAuthStateChange`
- `src/components/CommentsSection.tsx` -- блок комментариев: список + форма отправки

**Изменения в существующих файлах:**

- `Header.tsx` -- добавить кнопку "Войти" / отображение имени пользователя и "Выйти"
- `ReviewDetail.tsx` -- добавить кнопку "Перейти к комментариям" и компонент `CommentsSection` внизу рецензии

